You are updating the EventEscapes app.
Important: Do NOT modify or reference any flights logic, Duffel API keys, or flight-related components, hooks, or data files.
Only work on the hotel search and results integration described below.

ğŸ¯ Objective

Connect the Hotelbeds API (through our Supabase Edge Function) to the frontendâ€™s /hotels page â€” keeping the existing flight system 100% intact.

ğŸ§© Configuration

Supabase Edge Function URL:

https://jxrrhsqffnzeljszbecg.supabase.co/functions/v1/hotelbeds-hotels


Add this environment variable in .env (Replit secrets):

VITE_HOTELS_URL=https://jxrrhsqffnzeljszbecg.supabase.co/functions/v1/hotelbeds-hotels


Do not modify any existing Stripe, Supabase, or Duffel variables.

ğŸ§  Implementation Steps

Create a new file src/lib/hotels.ts

export const HOTELS_URL = import.meta.env.VITE_HOTELS_URL!;

export type HotelCard = {
  hotelId: number|string;
  name: string;
  stars?: number;
  thumbnail?: string|null;
  locality?: string;
  price: number;
  currency: string;
  board?: string;
  refundable?: boolean;
  paymentType?: string;
  rateKey: string;
};

export type HotelsResponse = { total: number; cards: HotelCard[] };

function qs(params: Record<string, string|number>) {
  return new URLSearchParams(params as any).toString();
}

export async function fetchHotels(params: Record<string, string|number>): Promise<HotelsResponse> {
  const url = `${HOTELS_URL}?${qs(params)}`;
  const res = await fetch(url, { headers: { Accept: "application/json" } });
  const contentType = res.headers.get("content-type") || "";
  if (!contentType.includes("application/json")) {
    const text = await res.text();
    throw new Error(`Unexpected response: ${text.slice(0, 120)}`);
  }
  if (!res.ok) {
    const err = await res.json().catch(() => ({}));
    throw new Error(err?.error || `Hotelbeds ${res.status}`);
  }
  return res.json();
}


Update only the /hotels page (no other pages):

Import the new fetchHotels function.

When the user clicks Search Hotels, call:

const params = {
  dest: destinationCode || "DXB",
  checkIn,
  checkOut,
  adults: Number(adults) || 2,
  rooms: Number(rooms) || 1,
  maxHotels: 24
};
const data = await fetchHotels(params);


Display the hotel cards returned by the API: name, stars, price, currency, board, refundable, thumbnail, and a â€œSelectâ€ button.

When a card is selected, log its rateKey via console.log(rateKey) (weâ€™ll connect booking later).

Error & empty states

Show the current â€œCouldnâ€™t load hotelsâ€ message if fetch fails.

Keep skeletons for loading state.

If no results, show a friendly empty state message: â€œNo hotels found for this search.â€

Strict isolation

Flights code, Duffel API calls, passenger data, and flight pages must remain completely untouched.

No imports, edits, or refactors in any file referencing â€œflightsâ€, â€œduffelâ€, or â€œpassengersâ€.

âœ… Acceptance Criteria

âœ… Hotels page successfully fetches from Supabase Edge Function (https://jxrrhsqffnzeljszbecg.supabase.co/...).

âœ… Results display dynamically with valid JSON data.

âœ… Flights remain fully functional and unaffected.

âœ… No TypeScript or build errors.

âœ… App runs successfully in Replit preview.

Once done, the Agent should summarize:

Which files were added or modified.

That flight-related code was not touched.

Confirmation that the API call returns valid JSON and populates hotel cards.